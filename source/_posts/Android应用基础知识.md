---
title: Android应用基础知识
date: 2020-03-29T15:03:29.000Z
category:
  - Android
tags:
  - Android
  - Linux
  - system权限
---

>  众所周知，Android 的内核是 Linux 系统，Linux 为了方便管理硬件，将硬件看作是一个个文件，而 Android 为了将每个应用隔离开来，更是将应用看作是一个个用户，每个用户都有着自己独立的进程、权限，下面来看一下为了给自己的应用获取更多的权限有哪些玩法吧。
<!-- more -->

* * *

## [Google 官方文档](https://developer.android.google.cn/guide/components/fundamentals)
每个 Android 应用都处于各自的安全沙盒中，并受以下 Android 安全功能的保护：

- Android 操作系统是一种多用户 Linux 系统，其中的每个应用都是一个不同的用户；
- 默认情况下，系统会为每个应用分配一个唯一的 Linux 用户 ID（该 ID 仅由系统使用，应用并不知晓）。系统会为应用中的所有文件设置权限，使得只有分配给该应用的用户 ID 才能访问这些文件；
- 每个进程都拥有自己的虚拟机 (VM)，因此应用代码独立于其他应用而运行。
- 默认情况下，每个应用都在其自己的 Linux 进程内运行。Android 系统会在需要执行任何应用组件时启动该进程，然后当不再需要该进程或系统必须为其他应用恢复内存时，其便会关闭该进程。

Android 系统实现了 _最小权限原则_ 。换言之，默认情况下，每个应用只能访问执行其工作所需的组件，而不能访问其他组件。这样便能创建非常安全的环境，在此环境中，应用无法访问其未获得权限的系统部分。不过，应用仍可通过一些途径与其他应用共享数据以及访问系统服务：

- ==可以安排两个应用共享同一 Linux 用户 ID，在此情况下，二者便能访问彼此的文件。为节省系统资源，也可安排拥有相同用户 ID 的应用在同一 Linux 进程中运行，并共享同一 VM。应用还必须使用相同的证书进行签名。==
- 应用可以请求访问设备数据（如用户的联系人、短信消息、可装载存储装置（SD 卡）、相机、蓝牙等）的权限。用户必须明确授予这些权限。如需了解详细信息，请参阅[使用系统权限](https://developer.android.google.cn/training/permissions)。

## 如何获取更多权限
大家在买手机的时候都会发现有一些系统应用，像软件商店、日历等等，这些应用有着更多的权限且不可卸载。这是因为手机厂商给这些应用单独开了一个 system 分区，在这个分区的应用都属于 system 用户组，被赋予了 system 权限。
1. 通过共享系统应用的用户 ID，两个应用在同一进程中运行，自然也拥有了相同的权限，但是两个应用必须使用相同的签名。
具体做法是修改AndroidManifest.xml文件，添加共享系统进程属性：
```language
android:sharedUserId="android.uid.system"
android:sharedUserId="android.uid.shared"
android:sharedUserId="android.media"
```
再使用系统签名，否则不能成功安装。
如果是自己的系统，可以直接在 system 分区安装一个僵尸应用，然后想将哪个应用变得不可卸载，就直接给哪个应用添加共享进程属性，使用相同的签名，就可以达到系统预装的效果了。